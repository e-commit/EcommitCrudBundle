{% set ajax_options = ajax_options|merge({ 'before': 'if(processCrudDisplaySettings_'~suffix~'() == false) { return false;}' }) %}
{% set reset_ajax_options = ajax_options|merge({ 'before': 'resetDisplaySettings'~suffix~'();' }) %}

<div id="display_settings_{{ suffix }}" class="crud_modal" style="width: 500px; text-align: left;">
<div class="contentWrap">
    <h1 class="titre">{% trans %}Display Settings{% endtrans %}</h1>
    {{ ecommit_javascript_jquery_ajax_form(url, ajax_options)  }}
        <b>{{ form_label(form.resultsPerPage) }} :</b><br />
        {{ form_widget(form.resultsPerPage) }}<br /><br />
        
        <b>{{ form_label(form.displayedColumns) }} :</b><br />
         {% for choice, child in form.displayedColumns %}
                {{ form_widget(child) }}  {{ form_label(child) }}<br />
         {% endfor %}
        {{ form_rest(form) }}

        <div style="text-align: center;">
            {%  if use_bootstrap %}
                <button type="submit" class="save-boostrap btn btn-success btn-sm">
                    <span class="glyphicon glyphicon-floppy-disk"></span> {% trans %}Save{% endtrans %}
                </button>
                {{ ecommit_javascript_jquery_ajax_button('<span class="glyphicon glyphicon-fire"></span>' ~ 'reset_display_settings'|trans, reset_settings_url, reset_ajax_options, {'class': 'raz-bootstrap btn btn-default btn-sm'}) }}
            {%  else %}
                <button type="submit" class="save">{% trans %}Save{% endtrans %}</button>
                {{ ecommit_javascript_jquery_ajax_button('reset_display_settings'|trans, reset_settings_url, reset_ajax_options, {'class': 'raz'}) }}
            {% endif %}
        </div>
    </form>
</div>
</div>

<script type="text/javascript">
    var dialogDisplaySettings{{ suffix }} = $('#display_settings_{{ suffix }}').overlay({oneInstance: false, api: true, fixed: false});
    function processCrudDisplaySettings_{{ suffix }}()
    {
       if($('#display_settings_{{ suffix }} input:checkbox:checked').length < 1)
       {
            alert('{% trans %}You need to select at least one column to display{% endtrans %}');
            return false;
       }
       dialogDisplaySettings{{ suffix }}.close();
    }
    function changeDisplaySettings{{ suffix }}()
    {
        dialogDisplaySettings{{ suffix }}.load();
    }
    function resetDisplaySettings{{ suffix }}()
    {
        dialogDisplaySettings{{ suffix }}.close();
    }
</script>

{%  if use_bootstrap %}
    <button type="button" class="display_settings-bootstrap btn btn-default btn-sm" onclick="changeDisplaySettings{{ suffix }}(); return false;">
        <span class="glyphicon glyphicon-cog"></span> {% trans %}Display Settings{% endtrans %}
    </button>
{% else %}
    <a href="#" onclick="changeDisplaySettings{{ suffix }}(); return false;"><img src="{{ asset(image_url) }}" alt="{% trans %}Display Settings{% endtrans %}" title="{% trans %}Display Settings{% endtrans %}" /></a>
{%  endif %}

<div id="js_holder_for_multi_update_{{ suffix }}" style="display: none;"></div>